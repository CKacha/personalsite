---
const BASE = import.meta.env.BASE_URL; 
const links = [
  { href: `${BASE}`,            label: "home" },
  { href: `${BASE}projects/`,   label: "my projects" },
  { href: `${BASE}logbook/`,    label: "logbook" },
  { href: `${BASE}blog/`,       label: "blog" },
];
---

<header class="topbar">
  <nav class="tabs">
    {links.map((l) => (
      <a href={l.href} class="tab">{l.label}</a>
    ))}
  </nav>
  <button id="toggleTheme" class="invert-btn" aria-pressed="false" aria-label="Invert site">invert</button>
</header>

<script is:inline>
  (function(){
    var root = document.documentElement;
    var base = root.getAttribute('data-base') || '/';
    var KEY = 'theme';

    var saved = localStorage.getItem(KEY);
    if (saved === 'light' || saved === 'dark') root.dataset.theme = saved;

    function joinBase(b, path) {
      if (!b.endsWith('/')) b += '/';
      path = String(path).replace(/^\/+/, '');
      return b + path;
    }

    function setIcon() {
      var isLight = root.dataset.theme === 'light';
      var file = isLight ? 'faviconinvert.svg' : 'favicon.svg';
      var href = joinBase(base, file) + '?v=' + (isLight ? '1' : '0');
      document.querySelectorAll('link[rel="icon"], link[rel="shortcut icon"]').forEach(function(link){
        link.setAttribute('type', 'image/svg+xml');
        link.setAttribute('href', href);
      });
    }
    setIcon();

    var btn = document.getElementById('toggleTheme');
    if (!btn) return;
    btn.addEventListener('click', function(){
      var next = root.dataset.theme === 'dark' ? 'light' : 'dark';
      root.dataset.theme = next;
      localStorage.setItem(KEY, next);
      btn.setAttribute('aria-pressed', String(next === 'light'));
      setIcon();
    });
  })();
</script>
